function RS_WS(e){this.ws=null,this.wsurl=rsData.wsUrl,this.lockReconnect=!1,this.timeout=3e4,this.timeoutTimer=null,this.serverTimeoutTimer=null,this.callback=e}RS_WS.prototype.initialization=function(){this.connection(),this.heartReset()},RS_WS.prototype.connection=function(){var o=this;o.ws=new WebSocket(this.wsurl),o.ws.onopen=function(){o.lockReconnect=!1,o.sendMessage({code:996,message:"第一次连"}),o.callback({data:"registerMqttService"}),o.heartReset()},o.ws.onmessage=function(e){var t,e=JSON.parse(e.data);return 1==e.code?(o.lockReconnect=!0,o.ws.close()):998==e.code||997==e.code?console.log(e.message):2==e.code&&(console.log("websocket",e),(t=JSON.parse(e.message)).data&&(t.data.userId&&(t.data.userID=t.data.userId),t.data.certBase64&&(t.data.signdCert=t.data.certBase64),t.data.authResult&&(t.data.signResult=t.data.authResult),rsData.addSocketContent(JSON.parse(e.message).data.transid,t)),e.data=JSON.stringify(t),o.callback(e)),o.heartReset(),this},o.ws.onerror=function(){o.reconnection()},o.ws.onclose=function(e){clearTimeout(o.timeoutTimer),clearTimeout(o.serverTimeoutTimer),o.lockReconnect?console.log("ws连接关闭"):(o.reconnection(),console.log("ws连接关闭,重连中..."))}},RS_WS.prototype.reconnection=function(){var e=this;e.lockReconnect||(e.lockReconnect=!0,setTimeout(function(){e.lockReconnect=!1,e.connection()},2e3))},RS_WS.prototype.close=function(){this.ws.close()},RS_WS.prototype.sendMessage=function(e){this.ws.send(JSON.stringify(e))},RS_WS.prototype.heartReset=function(){var e=this;clearTimeout(e.serverTimeoutTimer),clearTimeout(e.timeoutTimer),e.heartStart()},RS_WS.prototype.heartStart=function(){var t=this;t.timeoutTimer=setTimeout(function(){var e={code:999,ticket:(9999999999*Math.random()).toFixed(0)};t.ws.send(JSON.stringify(e)),t.serverTimeoutTimer=setTimeout(function(){t.callback(JSON.stringify({code:998,data:"",message:"心跳未返回信息"}))},t.timeout)},t.timeout)};
//V3.0.0.574