(function(f){function d(c,b,a){0<=c.indexOf(b)&&4>a&&(a++,c=c.substr(c.indexOf(b)+1,c.length),a=d(c,b,a));return a}var e=function(c){this.kg=new KG("IWEBASSIST.iWebAssistCtrl.1","4240FB41-A213-42B6-8CB5E6705C99B319");var b=createCapability();this.promise=b.promise;var a=this;this.kg.init().then(function(){"0"===(c||{}).cilentType?a.kg.invoke("SetParamByName","SOFTTYPE","0").then(function(){b.resolve()}):b.resolve()})};e.prototype={getCspName:function(){var c=this.kg,b=createCapability();c.invoke("KGGetPublicParm",
"Public","CSPName","").then(function(a){0==a.indexOf("M")&&0<d(a,"W",0)&&(a=a.replace(a.substring(a.indexOf("M")+1,a.indexOf("W")),"&"));b.resolve(a)});return b.promise},getKeyInfo:function(){return this.kg.invoke("KGGetKeyInfo")},getCert:function(){var c=this.kg,b=createCapability();c.invoke("KGGetCerInfo","").then(function(a){b.resolve(a)});return b.promise},sig_pkcs7:function(c,b,a){return"Base64"===a?this.kg.invoke("KGCrySignMessageEX",c,b,b.length,"Base64"):this.kg.invoke("KGCrySignMessage",
c,b,b.length)},verifyPin:function(c,b){var a=this.kg,d=createCapability();a.invoke("SetParamByName","ISKEYVERIFYPIN","1").then(function(){a.invoke("KGVerifyPin",c,b).then(function(a){d.resolve(a)})});return d.promise},getkeysn:function(){var c=this.kg,b=createCapability();c.invoke("SetParamByName","ISKEYVERIFYPIN","1").then(function(){c.invoke("KGGetKeyOtherInfo","0").then(function(a){a.result&&(a=a.Res.substring(1,a.Res.length-1),b.resolve(a))})});return b.promise}};f.iWebAssist=e})(window);  
